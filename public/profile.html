<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My Profile</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container profile-card">
    <div class="profile-card-header">
      <div class="profile-pic-large-container">
        <svg class="icon profile-icon-large" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
      </div>
      <div class="profile-card-info">
        <p><strong>Name:</strong> <span id="user-name"></span></p>
        <p><strong>Grade:</strong> <span id="user-grade"></span></p>
        <p><strong>Section:</strong> <span id="user-section"></span></p>
        <p><strong>Age:</strong> <span id="user-age">15</span></p> <!-- Placeholder -->
      </div>
    </div>
    <div class="profile-card-body">
      <div class="strengths">
        <h3>STRENGTHS:</h3>
        <ul id="strengths-list"></ul>
      </div>
      <div class="weaknesses">
        <h3>WEAKNESSES:</h3>
        <ul id="weaknesses-list"></ul>
      </div>
    </div>
     <div class="profile-actions">
      <a href="/edit-profile.html" class="button-link">Customize</a>
      <a href="/homepage.html" class="button-link" style="background: #7f8c8d;">Back to Dashboard</a>
    </div>
  </div>

  <script>

    const backendURL = "http://localhost:3000";

    window.onload = async function() {
      try {
        const response = await fetch(`${backendURL}/get-profile`);
        if (!response.ok) {
          throw new Error('Failed to fetch profile');
        }
        const data = await response.json();

        if (data.success) {
          const user = data.user;
          document.getElementById('user-name').innerText = `${user.name} ${user.surname}`;
          document.getElementById('user-grade').innerText = user.grade;
          document.getElementById('user-section').innerText = user.section;
          // Age is not in the database, so we'll leave the placeholder
          // document.getElementById('user-age').innerText = user.age;

          const strengthsList = document.getElementById('strengths-list');
          (user.strengths || []).forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            strengthsList.appendChild(li);
          });

          const weaknessesList = document.getElementById('weaknesses-list');
          (user.weaknesses || []).forEach(item => {
            const li = document.createElement('li');
            li.textContent = item;
            weaknessesList.appendChild(li);
          });
        } else {
          // Handle error - e.g., redirect to login
          window.location.href = '/index.html';
        }
      } catch (error) {
        console.error("Error fetching profile:", error);
        window.location.href = '/index.html';
      }
    };
  </script>
</body>
</html>